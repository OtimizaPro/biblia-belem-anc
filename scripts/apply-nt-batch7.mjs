#!/usr/bin/env node
/**
 * Batch NT Translation - Lote 7
 * Aplica traduções literais para palavras gregas freq 5 no NT (parte 1: nomes + A-κ)
 */

import { execSync } from 'child_process';
import { writeFileSync, unlinkSync } from 'fs';
import { tmpdir } from 'os';
import { join } from 'path';

const DB = 'biblia-belem';
const tmpFile = join(tmpdir(), `batch7-${Date.now()}.sql`);

const translations = [
  // === Nomes próprios ===
  ["Βαπτιστοῦ", "Batista"],
  ["Βαρνάβα", "Barnabé"],
  ["Βαρνάβᾳ", "Barnabé"],
  ["Βηθλέεμ", "Belém"],
  ["Εὐλογημένος", "Bendito"],
  ["Κάθου", "Senta-te"],
  ["Καισάριαν", "Cesareia"],
  ["Καισαρίαν", "Cesareia"],
  ["Κηφᾶς", "Cefas"],
  ["Κιλικίας", "Cilícia"],
  ["Κορνήλιος", "Cornélio"],
  ["Νικόδημος", "Nicodemos"],
  ["Οὐδέποτε", "Nunca"],
  ["Πνεύματός", "Espírito"],
  ["Πνεῦμά", "Espírito"],
  ["Σαδδουκαῖοι", "Saduceus"],
  ["Σολομῶνος", "Salomão"],
  ["Τίμα", "Honra"],
  ["Τίτου", "Tito"],
  ["Τύρου", "Tiro"],
  ["Φαρισαίους", "Fariseus"],
  ["Φιλίππῳ", "Filipe"],
  ["Χαῖρε", "Alegra-te"],
  ["Χριστόν", "Christos"],
  ["Ἀγρίππας", "Agripa"],
  ["Ἀσίαν", "Ásia"],
  ["Ἄνθρωπός", "Homem"],
  ["Ἄφετε", "Deixai"],
  ["Ἠκούσατε", "Ouvistes"],
  ["Ἰδὼν", "Vendo"],
  ["Ἰερουσαλὴμ", "Jerusalém"],
  ["Ἰουδαίου", "Judeu"],
  ["Ἰσκαριώτης", "Iscariotes"],
  ["Ὀψίας", "Tarde"],
  ["Ὁρᾶτε", "Vede"],
  // === Verbos ===
  ["αἰτήσει", "pedirá"],
  ["βάλλει", "lança"],
  ["βλασφημοῦντες", "blasfemando"],
  ["γεγέννηται", "foi-gerado"],
  ["γεγραμμένον", "escrito"],
  ["γενηθήτω", "seja-feito"],
  ["γινόμενα", "acontecendo"],
  ["γνόντες", "conhecendo"],
  ["γνώσεσθε", "conhecereis"],
  ["γράψαι", "escrever"],
  ["δεήσει", "súplica"],
  ["διακρινόμενος", "duvidando"],
  ["διελογίζοντο", "debatiam"],
  ["διηκόνουν", "serviam"],
  ["δυνάμενος", "podendo"],
  ["εἰπὸν", "dize"],
  ["εἰσελεύσονται", "entrarão"],
  ["εἴδετε", "vistes"],
  ["εἴδομεν", "vimos"],
  ["εἴρηκεν", "tem-dito"],
  ["εἶπόν", "dize"],
  ["εἶχον", "tinham"],
  ["εὐαγγελίσασθαι", "evangelizar"],
  ["εὐδόκησα", "agradei-me"],
  ["εὐλογήσας", "tendo-abençoado"],
  ["εὑρεῖν", "encontrar"],
  ["εὕρῃ", "encontre"],
  ["ζηλοῦτε", "zelai"],
  ["ζῶ", "vivo"],
  ["θερίζων", "ceifando"],
  ["θερίσει", "ceifará"],
  ["θεωρεῖτέ", "contemplais"],
  ["θεωρεῖτε", "contemplais"],
  ["καθαρισμοῦ", "purificação"],
  ["καθεξῆς", "por-ordem"],
  ["καθεύδοντας", "dormindo"],
  ["καλούμενος", "chamado"],
  ["κατάπαυσιν", "descanso"],
  ["κατέβησαν", "desceram"],
  ["κατέστησεν", "constituiu"],
  ["καταβάτω", "desça"],
  ["καταλῦσαι", "destruir"],
  ["καυχήσομαι", "gloriar-me-ei"],
  ["κερδήσω", "ganhe"],
  ["κράζοντες", "gritando"],
  ["κρίνεται", "é-julgado"],
  ["κρινεῖ", "julgará"],
  ["λάβῃ", "receba"],
  ["λήμψεσθε", "recebereis"],
  ["λαλήσω", "falarei"],
  ["λαμβάνοντες", "recebendo"],
  ["λογίζεται", "é-contado"],
  ["μαθητάς", "discípulos"],
  ["μεμαρτύρηκεν", "tem-testemunhado"],
  ["μενέτω", "permaneça"],
  ["μεριμνᾶτε", "andais-ansiosos"],
  ["νοεῖτε", "entendeis"],
  ["παρέδωκαν", "entregaram"],
  ["παρέλαβον", "recebi"],
  ["παραγενόμενοι", "tendo-chegado"],
  ["παρελεύσονται", "passarão"],
  ["πεποίηκεν", "tem-feito"],
  ["περιβλεψάμενος", "olhando-ao-redor"],
  ["περιπατοῦντα", "andando"],
  ["περιπατοῦντες", "andando"],
  ["περισσεύειν", "abundar"],
  ["πιστεύειν", "crer"],
  ["πιστεύητε", "creiais"],
  ["ποιήσουσιν", "farão"],
  ["ποιοῦν", "fazendo"],
  ["ποιῇς", "fazes"],
  ["προσέπεσεν", "prostrou-se"],
  ["προσέταξεν", "ordenou"],
  ["προσέχετε", "guardai-vos"],
  ["προσευξάμενοι", "tendo-orado"],
  ["προσευχόμενος", "orando"],
  ["προσηύχετο", "orava"],
  ["προσκαρτεροῦντες", "perseverando"],
  ["πωλοῦντας", "vendendo"],
  ["σταθήσεται", "será-estabelecido"],
  ["ὑπάγειν", "ir"],
  ["ὑπάγεις", "vais"],
  ["ὑπάγετε", "ide"],
  ["ὑπακούετε", "obedecei"],
  ["ὑπακούουσιν", "obedecem"],
  ["ὑποτάσσεται", "sujeita-se"],
  ["ᾠκοδόμησεν", "edificou"],
  ["ἀκολούθει", "segue"],
  ["ἀκούσητε", "ouçais"],
  ["ἀνέχεσθε", "suportais"],
  ["ἀνελήμφθη", "foi-elevado"],
  ["ἀνοίξας", "abrindo"],
  ["ἀπέχεσθαι", "abster-se"],
  ["ἀπεδήμησεν", "viajou"],
  ["ἀποθνήσκειν", "morrer"],
  ["ἀπολύσῃ", "solte"],
  ["ἀσπάζεται", "saúda"],
  ["ἀφίεται", "é-perdoado"],
  ["ἀφεὶς", "deixando"],
  ["ἀφιέναι", "perdoar"],
  ["ἀφῆτε", "perdoeis"],
  ["ἐβαπτίζοντο", "eram-batizados"],
  ["ἐβαπτίσθη", "foi-batizado"],
  ["ἐγενήθησαν", "tornaram-se"],
  ["ἐγενήθητε", "tornastes-vos"],
  ["ἐδέξαντο", "receberam"],
  ["ἐθαύμασεν", "admirou-se"],
  ["ἐκβάλλω", "expulso"],
  ["ἐκβάλῃ", "expulse"],
  ["ἐκείνη", "aquela"],
  ["ἐκείνους", "aqueles"],
  ["ἐλεύσομαι", "virei"],
  ["ἐλθοῦσα", "tendo-vindo"],
  ["ἐμνήσθησαν", "lembraram-se"],
  ["ἐξέβαλεν", "expulsou"],
  ["ἐξέστησαν", "ficaram-fora-de-si"],
  ["ἐξαπέστειλαν", "enviaram-embora"],
  ["ἐπάρας", "levantando"],
  ["ἐπέθηκεν", "pôs-sobre"],
  ["ἐπέστησαν", "aproximaram-se"],
  ["ἐπέτρεψεν", "permitiu"],
  ["ἐπίστασθε", "sabeis"],
  ["ἐπηγγείλατο", "prometeu"],
  ["ἐπιγνοὺς", "reconhecendo"],
  ["ἐπιγνόντες", "reconhecendo"],
  ["ἐπιθεὶς", "pondo-sobre"],
  ["ἐπιλαβόμενος", "tomando"],
  ["ἐπλήσθη", "encheu-se"],
  ["ἐπορεύοντο", "iam"],
  ["ἐπυνθάνετο", "inquiria"],
  ["ἐργάζεται", "trabalha"],
  ["ἐρωτᾷ", "pede"],
  ["ἐτέλεσεν", "terminou"],
  ["ἐφάνη", "apareceu"],
  ["ἐφανέρωσεν", "manifestou"],
  ["ἐφοβήθη", "temeu"],
  ["ἐχάρησαν", "alegraram-se"],
  ["ἔγειρε", "levanta-te"],
  ["ἔγνωσαν", "conheceram"],
  ["ἔδωκας", "deste"],
  ["ἔκραζεν", "gritava"],
  ["ἔξεστίν", "é-lícito"],
  ["ἔσχεν", "teve"],
  ["ἔσχον", "tiveram"],
  ["ἔφαγεν", "comeu"],
  ["ἠγάπα", "amava"],
  ["ἠκολούθει", "seguia"],
  ["ἠρώτα", "perguntava"],
  ["ἤκουεν", "ouvia"],
  ["ἤκουον", "ouviam"],
  ["ἤνεγκεν", "trouxe"],
  // === Substantivos ===
  ["βεβαίαν", "firme"],
  ["βρώματα", "alimentos"],
  ["βρῶμα", "alimento"],
  ["γένει", "raça"],
  ["γένους", "raça"],
  ["γεγονὸς", "tendo-acontecido"],
  ["γεωργοὶ", "lavradores"],
  ["γεωργοῖς", "lavradores"],
  ["γονεῦσιν", "pais"],
  ["γραφάς", "escrituras"],
  ["γύναι", "mulher"],
  ["δέσμιον", "prisioneiro"],
  ["δηνάριον", "denário"],
  ["διαθήκην", "aliança"],
  ["διανοίᾳ", "entendimento"],
  ["διδαχῆς", "ensino"],
  ["διδοὺς", "dando"],
  ["δικαίου", "justo"],
  ["δοῦλε", "servo"],
  ["δυνατός", "poderoso"],
  ["δὶς", "duas-vezes"],
  ["δῶμεν", "demos"],
  ["εὐάρεστον", "agradável"],
  ["εὐθείας", "retas"],
  ["εὐκοπώτερον", "mais-fácil"],
  ["εὐνοῦχος", "eunuco"],
  ["εὐχαριστίας", "ação-de-graças"],
  ["ζώντων", "viventes"],
  ["ζῶσαν", "vivente"],
  ["θησαυρὸν", "tesouro"],
  ["θλίψεσιν", "tribulações"],
  ["θυσιαστηρίῳ", "altar"],
  ["θῶ", "ponha"],
  ["κάλαμον", "cana"],
  ["καίπερ", "embora"],
  ["καινὴ", "nova"],
  ["καιροῖς", "tempos"],
  ["κεφαλήν", "cabeça"],
  ["κεφαλῆς", "cabeça"],
  ["κληρονόμοι", "herdeiros"],
  ["κλητοῖς", "chamados"],
  ["κλῆρον", "sorte"],
  ["κοινωνοὶ", "participantes"],
  ["κονιορτὸν", "poeira"],
  ["κοράσιον", "menina"],
  ["κρείττονος", "melhor"],
  ["κυρίοις", "senhores"],
  ["κύριοι", "senhores"],
  ["λειτουργίας", "serviço"],
  ["λύπη", "tristeza"],
  ["λύπην", "tristeza"],
  ["λύχνος", "lâmpada"],
  ["μέλος", "membro"],
  ["μένουσαν", "permanecendo"],
  ["μία", "uma"],
  ["μαχαιρῶν", "espadas"],
  ["μείνατε", "permanecei"],
  ["μεῖζον", "maior"],
  ["μεῖναι", "permanecer"],
  ["μητρί", "mãe"],
  ["μισθὸς", "salário"],
  ["μισῶν", "odiando"],
  ["μνᾶς", "minas"],
  ["νήπιος", "infante"],
  ["νοήματα", "pensamentos"],
  ["νότου", "sul"],
  ["ξύλων", "madeiras"],
  ["οἰκοδεσπότης", "dono-de-casa"],
  ["οὔσης", "sendo"],
  ["οὖσα", "sendo"],
  ["πέτραν", "rocha"],
  ["πήραν", "alforje"],
  ["παιδίσκη", "serva"],
  ["παραλυτικῷ", "paralítico"],
  ["παρρησίας", "ousadia"],
  ["πατρίδι", "pátria"],
  ["περιτομή", "circuncisão"],
  ["περιτομὴν", "circuncisão"],
  ["περιτομῇ", "circuncisão"],
  ["πλήρεις", "cheios"],
  ["πλειόνων", "mais"],
  ["πλούσιος", "rico"],
  ["ποιμένα", "pastor"],
  ["ποιούμενος", "fazendo"],
  ["πολὺ", "muito"],
  ["πονηροὺς", "maus"],
  ["ποτέ", "alguma-vez"],
  ["πραΰτητος", "mansidão"],
  ["πραιτώριον", "pretório"],
  ["πρεσβυτέροις", "presbíteros"],
  ["προφάσει", "pretexto"],
  ["πόθεν", "de-onde"],
  ["σεαυτῷ", "a-ti-mesmo"],
  ["σινάπεως", "mostarda"],
  ["σπέρματι", "semente"],
  ["σπουδὴν", "diligência"],
  ["στρατιωτῶν", "soldados"],
  ["στρατιώτας", "soldados"],
  ["στῆναι", "estar-de-pé"],
  ["συγγενεῖς", "parentes"],
  ["σχίσμα", "divisão"],
  ["σχῶ", "tenha"],
  ["σῶσον", "salva"],
  ["σῷ", "teu"],
  ["τέλειοι", "perfeitos"],
  ["τίθημι", "ponho"],
  ["ταχὺ", "rapidamente"],
  ["τελώνης", "cobrador-de-impostos"],
  ["τιμήν", "honra"],
  ["τιμῇ", "honra"],
  ["τοιούτους", "tais"],
  ["τούτοις", "nestes"],
  ["τρισὶν", "três"],
  ["τρώγων", "comendo"],
  ["τρὶς", "três-vezes"],
  ["τυφλὸν", "cego"],
  ["τόπους", "lugares"],
  ["φάγω", "coma"],
  ["φάγωμεν", "comamos"],
  ["φέρετε", "trazei"],
  ["φέρουσιν", "trazem"],
  ["φωνήσας", "chamando"],
  ["φωνὴ", "voz"],
  ["φωτός", "luz"],
  ["φύλλα", "folhas"],
  ["φύσει", "natureza"],
  ["φύσιν", "natureza"],
  ["χήρας", "viúvas"],
  ["χεῖράς", "mãos"],
  ["χοίρους", "porcos"],
  ["χρείας", "necessidade"],
  ["χωρίον", "campo"],
  ["ψευδοπροφῆται", "falsos-profetas"],
  ["ψυχῆς", "alma"],
  // === Adjetivos / Pronomes / Partículas ===
  ["αὐτὰς", "a-elas"],
  ["βασιλεῖ", "rei"],
  ["ἐκλογὴν", "eleição"],
  ["ἐλέους", "misericórdia"],
  ["ἐλευθερίαν", "liberdade"],
  ["ἐμαυτῷ", "a-mim-mesmo"],
  ["ἐνάτην", "nona"],
  ["ἐξαίφνης", "subitamente"],
  ["ἐπιθυμίαν", "desejo"],
  ["ἐπιούσῃ", "seguinte"],
  ["ἐπιταγὴν", "mandado"],
  ["ἐπουρανίοις", "celestiais"],
  ["ἐσχάτου", "último"],
  ["ἐφάπαξ", "de-uma-vez-por-todas"],
  ["ἐχθρὸς", "inimigo"],
  ["ἑαυτούς", "a-si-mesmos"],
  ["ἑβδομήκοντα", "setenta"],
  ["ἑξῆς", "na-sequência"],
  ["ἑορτῆς", "festa"],
  ["ἔγνωσαν", "conheceram"],
  ["ἔσω", "dentro"],
  ["ἔχουσα", "tendo"],
  ["ἕτοιμοι", "prontos"],
  ["ἠγάπα", "amava"],
  ["ἡγεμόνος", "governador"],
  ["ἤμεθα", "estávamos"],
  ["ἰδίους", "próprios"],
  ["ἱμάτιον", "manto"],
  ["ἴδετε", "vede"],
  ["ἴδωμεν", "vejamos"],
  ["ἴδῃ", "veja"],
  ["ἴσθι", "sê"],
  ["ὁμοιώματι", "semelhança"],
  ["ὅτου", "de-quem"],
  ["ὑπακοὴν", "obediência"],
  ["ὑπαρχόντων", "posses"],
  ["ὑποπόδιον", "estrado"],
  ["ὑποταγῇ", "sujeição"],
  ["ὑπῆρχεν", "existia"],
  ["ὠσὶν", "ouvidos"],
  ["ὤν", "sendo"],
  ["ἀγαθά", "boas-coisas"],
  ["ἀγαθὴν", "boa"],
  ["ἀγαπῶ", "amo"],
  ["ἀγαπῶσιν", "amam"],
  ["ἀγῶνα", "luta"],
  ["ἀδελφέ", "irmão"],
  ["ἀδελφὴν", "irmã"],
  ["ἀδικίᾳ", "injustiça"],
  ["ἀδύνατον", "impossível"],
  ["ἀκαθάρτῳ", "impuro"],
  ["ἀκανθῶν", "espinhos"],
  ["ἀκηκόαμεν", "temos-ouvido"],
  ["ἀκοῆς", "ouvido"],
  ["ἀκριβῶς", "com-exatidão"],
  ["ἀλέκτορα", "galo"],
  ["ἀνάγκη", "necessidade"],
  ["ἀναστροφῆς", "conduta"],
  ["ἀνεκτότερον", "mais-tolerável"],
  ["ἀπειθεῖς", "desobedientes"],
  ["ἀπιστίᾳ", "incredulidade"],
  ["ἀπωλείας", "perdição"],
  ["ἀπὼν", "estando-ausente"],
  ["ἀρχόντων", "governantes"],
  ["ἀρχῇ", "princípio"],
  ["ἀσθενείᾳ", "fraqueza"],
  ["ἀσθενεῖ", "está-fraco"],
  ["ἀφθαρσίαν", "incorruptibilidade"],
  ["ἁγιασμῷ", "santificação"],
  ["ἁλεεῖς", "pescadores"],
  ["ἁμαρτωλός", "pecador"],
  ["ἁμαρτωλῷ", "pecador"],
  ["ἄνθρωπε", "homem"],
  ["ἄρας", "levantando"],
  ["ἄρτου", "pão"],
  ["ἄρχοντα", "governante"],
  ["ἄρῃ", "levante"],
  ["ἄφετε", "deixai"],
  ["ποία", "qual"],
  ["ποίῳ", "qual"],
  ["πίπτει", "cai"],
  ["ῥίζα", "raiz"],
  ["ἀνθ'", "em-lugar-de"],
  ["ἐσχάτου", "último"],
  ["ἐκλογὴν", "eleição"],
  ["ἐλέους", "misericórdia"],
  ["ἐλευθερίαν", "liberdade"],
];

let success = 0;
let errors = 0;
let totalUpdated = 0;

console.log(`\n=== Tradução NT - Lote 7 (freq 5) ===`);
console.log(`Palavras a traduzir: ${translations.length}`);
console.log(`Início: ${new Date().toLocaleString('pt-BR')}\n`);

for (const [word, translation] of translations) {
  try {
    const escapedWord = word.replace(/'/g, "''");
    const escapedTranslation = translation.replace(/'/g, "''");

    const sql = `UPDATE tokens SET pt_literal = '${escapedTranslation}' WHERE text_utf8 = '${escapedWord}' AND pt_literal LIKE '[%]';`;

    writeFileSync(tmpFile, sql, 'utf-8');
    const result = execSync(
      `npx wrangler d1 execute ${DB} --remote --file "${tmpFile}" --json`,
      { encoding: 'utf-8', timeout: 30000 }
    );

    // Strip non-JSON output (--file adds progress indicators)
    const jsonStart = result.indexOf('[');
    const jsonStr = result.substring(jsonStart);
    const parsed = JSON.parse(jsonStr);
    const changes = parsed[0]?.meta?.changes || 0;
    totalUpdated += changes;

    if (changes > 0) {
      process.stdout.write(`✓ ${word} → ${translation} (${changes})\n`);
    } else {
      process.stdout.write(`· ${word} → ${translation} (0)\n`);
    }
    success++;
  } catch (err) {
    process.stdout.write(`✗ ${word} → ${translation} (ERRO)\n`);
    errors++;
  }
}

try { unlinkSync(tmpFile); } catch {}

console.log(`\n=== Resultado Lote 7 ===`);
console.log(`Sucesso: ${success}/${translations.length}`);
console.log(`Erros: ${errors}`);
console.log(`Tokens atualizados: ${totalUpdated}`);
console.log(`Fim: ${new Date().toLocaleString('pt-BR')}\n`);
